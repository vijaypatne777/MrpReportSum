sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/ui/table/library","sap/ui/core/format/DateFormat","sap/ui/model/Sorter","sap/m/Token","sap/ui/model/type/String","sap/ui/model/json/JSONModel","sap/m/ColumnListItem","sap/m/Label","sap/ui/core/util/Export","sap/m/MessageBox","sap/ui/core/util/ExportTypeCSV"],function(e,t,a,r,l,i,n,s,o,p,d,u,m){"use strict";var M=a.SortOrder;var P="/OPENSAP/sap/opu/odata/sap/API_MRP_MATERIALS_SRV_01";var R={};var v={items:[]};var f={MatList:[]};var v={BotList:[]};var y={oBotList:[]};var S;return e.extend("PP.mrpReport.controller.Home",{onInit:function(){var e=this.getView();var t=e.byId("multiInput2");t.addValidator(function(e){var t=e.text;return new i({key:t,text:t})})},onSubmitInput:function(e){var t=e.getParameters().value.toUpperCase();if(t!==""){var a=this.getView();var r=a.byId("multiInput2");var l={items:[]};var i="/OPENSAP/sap/opu/odata/sap/API_MRP_MATERIALS_SRV_01";var n=new sap.ui.model.odata.ODataModel(i,true);var s=this.getView().byId("idFieldPlant").getValue().toUpperCase();var o=this.getView().byId("idFieldMRPArea").getValue().toUpperCase();var p=[];p.push(new sap.ui.model.Filter("Material",sap.ui.model.FilterOperator.EQ,t));var d=new sap.ui.model.Filter({filters:p,or:true,_bMultiFilter:false});var u=new sap.ui.model.Filter("MRPPlant",sap.ui.model.FilterOperator.EQ,s);var m=new sap.ui.model.Filter({filters:[u],and:true});var M=new sap.ui.model.Filter("MRPArea",sap.ui.model.FilterOperator.EQ,o);var P=new sap.ui.model.Filter({filters:[M],and:true});var R=new Array(new sap.ui.model.Filter({filters:[m,P,d],and:true}));n.read("/A_MRPMaterial",{async:false,filters:[R],success:function(e,a){var r=e.results;var i=r.length;if(i!==0){for(var n=0;n<i;n++){l.items.push({Material:r[n].Material,MaterialName:r[n].MaterialName})}}else{S=null;l=null;sap.m.MessageToast.show("No value found for material   "+t+".Please delete.");t=null}}})}},onDataExport:function(e){var t=new sap.ui.model.json.JSONModel;t.setData(v.BotList);var a=new d({exportType:new sap.ui.core.util.ExportTypeCSV({separatorChar:",",charset:"utf-8"}),models:t,rows:{path:"/"},columns:[{name:"Material",template:{content:"{Material}"}},{name:"MRPPlant",template:{content:"{MRPPlant}"}},{name:"MRPArea",template:{content:"{MRPArea}"}},{name:"MaterialName",template:{content:"{MaterialName}"}},{name:"Supplier",template:{content:"{MRPElementBusinessPartner}"}},{name:"End Date",template:{content:"{MRPElementAvailyOrRqmtDate}"}},{name:"Availablity",template:{content:"{MRPAvailableQuantity}"}},{name:"Availablity Date",template:{content:"{MRPAvailableQuantityDate}"}},{name:"SafetyStk",template:{content:"{SafetyStk}"}},{name:"Stock",template:{content:"{Stock}"}},{name:"AvailableStock",template:{content:"{AvailableStock}"}},{name:"DependReq",template:{content:"{DependReq}"}},{name:"PurchReq",template:{content:"{PurchReq}"}},{name:"DependReq",template:{content:"{DependReq}"}},{name:"Plndorder",template:{content:"{Plndorder}"}},{name:"IndReqmt",template:{content:"{IndReqmt}"}},{name:"Order",template:{content:"{Order}"}},{name:"ProdOrder",template:{content:"{ProdOrder}"}},{name:"Delivery",template:{content:"{Delivery}"}},{name:"POitem",template:{content:"{POitem}"}},{name:"OrderRes",template:{content:"{OrderRes}"}},{name:"RetrnsItem",template:{content:"{RetrnsItem}"}}]});a.saveFile().always(function(){this.destroy()})},onHelpTable:function(e){sap.m.MessageToast.show("Please wait !!! fetching list of Material for you ");var t=this.getView().byId("idFieldPlant").getValue().toUpperCase();var a=this.getView().byId("idFieldMRPArea").getValue().toUpperCase();if(t!==""||a!==""){var r={items:[]};if(!this.tableDialog){this.tableDialog=sap.ui.xmlfragment("PP.mrpReport.fragments.ValueHelpPopup",this);this.getView().addDependent(this.tableDialog);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.tableDialog)}this.tableDialog.open();var l=sap.ui.getCore().byId("botTabDialog");l.getColumns()[1].setProperty("visible",true);var i=new sap.ui.model.json.JSONModel;i.setData(r);var n="/OPENSAP/sap/opu/odata/sap/API_MRP_MATERIALS_SRV_01";var s=new sap.ui.model.odata.ODataModel(n,true);var o="A_MRPMaterial";debugger;var p=this.getView().byId("idMRPControl").getValue().toUpperCase();this.tableDialog.setBusy(true);if(p===""){var d="/A_MRPMaterial?$orderby=Material&$select=Material,MaterialName&$filter=( MRPPlant eq '"+t+"' and MRPArea eq '"+a+"')"}if(p!==""){var d="/A_MRPMaterial?$orderby=Material&$select=Material,MaterialName,MRPController&$filter=( MRPPlant eq '"+t+"' and MRPArea eq '"+a+"' and MRPController eq '"+p+"')"}s.read(d,{success:function(e,t){var a=e.results;var n=a.length;if(n!==0){for(var s=0;s<n;s++){r.items.push({Material:a[s].Material,MaterialName:a[s].MaterialName,MRPController:a[s].MRPController})}}else{r=null;sap.m.MessageToast.show("The Search Criteria fetched no result. Please enter valid values")}i.setData(r);y=r;l.setModel(i,"botTabModel3");l.setVisible(true)}})}else{sap.m.MessageToast.show("Please provide MRP Area and Plant")}this.tableDialog.setBusy(false)},onConfirm:function(e){var t={MatList:[]};var a=sap.ui.getCore().byId("botTabDialog");var r=a.getModel("botTabModel3");var l=a.getSelectedItems();var i=l.length;var n=this.getView();var s=n.byId("multiInput2");for(var o=0;o<i;o++){var p=a.getSelectedItems()[o].oBindingContexts.botTabModel3.sPath;var d=a.getSelectedItems()[o].oBindingContexts.botTabModel3.sPath.slice(7,15);var u=r.oData.items[d].Material;var m=r.oData.items[d].MaterialName;s.addToken(new sap.m.Token({key:u,text:u}));t.MatList.push({Material:u,MaterialName:m})}this.tableDialog.close()},onCancel:function(){this.tableDialog.close()},onSuggestLive:function(e){var t={items:[]};var a="/OPENSAP/sap/opu/odata/sap/API_MRP_MATERIALS_SRV_01";var r=new sap.ui.model.odata.ODataModel(a,true);var l="A_MRPMaterial";var i=this.getView();var n=i.byId("multiInput2");var s=this.getView().byId("idFieldPlant").getValue().toUpperCase();var o=this.getView().byId("idFieldMRPArea").getValue().toUpperCase();var p=[];p.push(new sap.ui.model.Filter("Material",sap.ui.model.FilterOperator.EQ,n.getValue().toUpperCase()));var d=new sap.ui.model.Filter({filters:p,or:true,_bMultiFilter:false});var u=new sap.ui.model.Filter("MRPPlant",sap.ui.model.FilterOperator.EQ,s);var m=new sap.ui.model.Filter({filters:[u],and:true});var M=new sap.ui.model.Filter("MRPArea",sap.ui.model.FilterOperator.EQ,o);var P=new sap.ui.model.Filter({filters:[M],and:true});var R=new Array(new sap.ui.model.Filter({filters:[m,P,d],and:true}));r.read("/A_MRPMaterial",{async:false,filters:[R],success:function(e,a){var r=e.results;var l=r.length;if(l!==0){for(var i=0;i<l;i++){t.items.push({Material:r[i].Material,MaterialName:r[i].MaterialName})}}else{t=null;sap.m.MessageToast.show("The Search Criteria fetched no result. Please enter valid values")}}});var v=e.getParameter("suggestValue");var f=new sap.ui.model.json.JSONModel;var i=this.getView();var n=i.byId("multiInput2");var y=n.getValue();n.setValue="";f.setData(t);for(var S=0;S<t.items.length;S++){n.addToken(new sap.m.Token({key:t.items[S].Material,text:t.items[S].Material}))}i.setModel(f,"botModelSugg");this.oSF=sap.ui.getCore().byId("searchField");this.oSF.suggest()},_validateMaterial:function(){var e=this.getView().byId("idMRPControl").getValue().toUpperCase();var t=this.getView().byId("idFieldPlant").getValue().toUpperCase();var a=this.getView().byId("idFieldMRPArea").getValue().toUpperCase();var r=this.getView();var l=r.byId("multiInput2");var i=l.getTokens();var n={items:[]};var s="/OPENSAP/sap/opu/odata/sap/API_MRP_MATERIALS_SRV_01";var o=new sap.ui.model.odata.ODataModel(s,true);var p=[];for(var d=0;d<i.length;d++){p.push(new sap.ui.model.Filter("Material",sap.ui.model.FilterOperator.EQ,i[d].mProperties.key.toUpperCase()))}var u=new sap.ui.model.Filter({filters:p,or:true,_bMultiFilter:false});var m=new sap.ui.model.Filter("MRPPlant",sap.ui.model.FilterOperator.EQ,t);var M=new sap.ui.model.Filter({filters:[m],and:true});var P=new sap.ui.model.Filter("MRPArea",sap.ui.model.FilterOperator.EQ,a);var R=new sap.ui.model.Filter({filters:[P],and:true});var v=new Array(new sap.ui.model.Filter({filters:[M,R,u],and:true}));o.read("/A_MRPMaterial",{async:false,filters:[v],success:function(e,t){var a=e.results;var r=a.length;if(r!==0){for(var l=0;l<r;l++){n.items.push({Material:a[l].Material,MaterialName:a[l].MaterialName})}}}});return n.items},onSearch:function(e){var t=this.getView().byId("idMRPControl").getValue().toUpperCase();var a=this.getView().byId("idFieldPlant").getValue().toUpperCase();var r=this.getView().byId("idFieldMRPArea").getValue().toUpperCase();var l=this.getView();var i=l.byId("multiInput2");var n=i.getTokens();var s={items:[]};s.items=this._validateMaterial();if(a!==""||r!==""||n.length>0){var o=[];for(var p=0;p<n.length;p++){o.push(new sap.ui.model.Filter("Material",sap.ui.model.FilterOperator.EQ,i.getTokens()[p].mProperties.key.toUpperCase()))}var d=new sap.ui.model.Filter({filters:o,or:true,_bMultiFilter:false});var u=new sap.ui.model.Filter("MRPPlant",sap.ui.model.FilterOperator.EQ,a);var m=new sap.ui.model.Filter({filters:[u],and:true});var M=new sap.ui.model.Filter("MRPArea",sap.ui.model.FilterOperator.EQ,r);var P=new sap.ui.model.Filter({filters:[M],and:true});var R=new Array(new sap.ui.model.Filter({filters:[m,P,d],and:true}));debugger;if(t!==""){var f=new sap.ui.model.Filter("MRPController",sap.ui.model.FilterOperator.EQ,t);var y=new sap.ui.model.Filter({filters:[f],and:true});var R=new Array(new sap.ui.model.Filter({filters:[m,P,d,y],and:true}))}var S="/OPENSAP/sap/opu/odata/sap/API_MRP_MATERIALS_SRV_01";var c="/SupplyDemandItems";var b=new sap.ui.model.odata.ODataModel(S,true);b.setHeaders({"Content-Type":"application/json",Accept:"application/json",APIKey:"jQdx3TI7jIFCKaxK3GR4r5dYqF8heA4q"});var O={};var g=[];var F={};var A=[];b.read(c,{async:false,filters:[R],success:function(e,t){var a=e.results;var r=a.length;var l=0;debugger;var i;for(var n=0;n<r;n++){l++;if(a[n].MRPAvailableQuantity>0&&a[n].MRPElementCategoryShortName!=="SafetyStk"&&i!=="true"){O.MRPAvailableQuantity=parseFloat(a[n].MRPAvailableQuantity);O.MRPAvailableQuantityDate=a[n].MRPElementAvailyOrRqmtDate.toISOString();i="true"}if(l===r){if(a[n].MRPElementCategoryShortName==="SafetyStk"){var s=parseFloat(a[n].MRPElementOpenQuantity);O.Material=a[n].Material;O.SafetyStk=parseFloat(O.SafetyStk)+s;if(O.SafetyStk===undefined){O.SafetyStk=0}if(O.SafetyStk!==0){O.SafetyStk*=-1}g.push(O);i="false";s=0;O={}}else{O.Material=a[n].Material;O.SafetyStk=s;if(O.SafetyStk===undefined){O.SafetyStk=0}if(O.SafetyStk!==0){O.SafetyStk*=-1}g.push(O);i="false";s=0;O={}}}else{if(a[n].Material===a[n+1].Material){if(a[n].MRPElementCategoryShortName==="SafetyStk"){var s=parseFloat(a[n].MRPElementOpenQuantity);O.Material=a[n].Material;O.SafetyStk=parseFloat(O.SafetyStk)+s}}else{if(a[n].MRPElementCategoryShortName==="SafetyStk"){var s=parseFloat(a[n].MRPElementOpenQuantity);O.Material=a[n].Material;O.SafetyStk=parseFloat(O.SafetyStk)+s;if(O.SafetyStk===undefined){O.SafetyStk=0}if(O.SafetyStk!==0){O.SafetyStk*=-1}g.push(O);i="false";s=0;O={}}else{O.Material=a[n].Material;O.SafetyStk=s;if(O.SafetyStk===undefined){O.SafetyStk=0}if(O.SafetyStk!==0){O.SafetyStk*=-1}g.push(O);i="false";s=0;O={}}}}F.Material=a[n].Material;F.MRPPlant=a[n].MRPPlant;F.MRPArea=a[n].MRPArea;F.MRPController=a[n].MRPController;F.MRPElementCategoryShortName=a[n].MRPElementCategoryShortName;F.MRPElementOpenQuantity=a[n].MRPElementOpenQuantity;F.MRPElementAvailyOrRqmtDate=new Date(a[n].MRPElementAvailyOrRqmtDate);F.MaterialBaseUnit=a[n].MaterialBaseUnit;F.MRPElementBusinessPartner=a[n].MRPElementBusinessPartner;A.push(F);F={}}}});var h={};var E=[];var k=A.length;for(var Q=0;Q<k;Q++){for(var D=0;D<s.items.length;D++){if(A[Q].Material===s.items[D].Material){h.MaterialName=s.items[D].MaterialName;break}}for(var w=0;w<g.length;w++){if(A[Q].Material===g[w].Material){h.SafetyStk=g[w].SafetyStk;h.MRPAvailableQuantity=g[w].MRPAvailableQuantity;h.MRPAvailableQuantityDate=g[w].MRPAvailableQuantityDate;break}}h.Material=A[Q].Material;h.MRPPlant=A[Q].MRPPlant;h.MRPArea=A[Q].MRPArea;h.MRPController=A[Q].MRPController;h.MaterialBaseUnit=A[Q].MaterialBaseUnit;h.MRPElementAvailyOrRqmtDate=A[Q].MRPElementAvailyOrRqmtDate;h.MRPElementCategoryShortName=A[Q].MRPElementCategoryShortName;h.MRPElementOpenQuantity=A[Q].MRPElementOpenQuantity;h.MRPElementBusinessPartner=A[Q].MRPElementBusinessPartner;E.push(h);h={}}var I=[];I=E;var C=0;var h={};var q=[];h.Stock=0;h.SafetyStk=0;h.AvailableStock=0;h.DependReq=0;h.PurchReq=0;for(var Q=0;Q<I.length;Q++){C++;if(C===I.length){var V="X";var N=I[Q].MRPElementCategoryShortName;var T=N.trim();switch(T){case"Stock":if(h.Stock===undefined){h.Stock=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.Stock=parseFloat(h.Stock)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"DependReq":if(h.DependReq===undefined){h.DependReq=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.DependReq=parseFloat(h.DependReq)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"PurchReq":if(h.PurchReq===undefined){h.PurchReq=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.PurchReq=parseFloat(h.PurchReq)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"Plnd order":if(h.Plndorder===undefined){h.Plndorder=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.Plndorder=parseFloat(h.Plndorder)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"IndReqmt":if(h.IndReqmt===undefined){h.IndReqmt=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.IndReqmt=parseFloat(h.IndReqmt)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"Order":if(h.Order===undefined){h.Order=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.Order=parseFloat(h.Order)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"ProdOrder":if(h.ProdOrder===undefined){h.ProdOrder=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.ProdOrder=parseFloat(h.ProdOrder)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"Delivery":if(h.Delivery===undefined){h.Delivery=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.Delivery=parseFloat(h.Delivery)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"PO item":if(h.POitem===undefined){h.POitem=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.POitem=parseFloat(h.POitem)+parseFloat(I[Q].MRPElementOpenQuantity)}h.MRPElementBusinessPartner=I[Q].MRPElementBusinessPartner;break;case"OrderRes":if(h.OrderRes===undefined){h.OrderRes=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.OrderRes=parseFloat(h.OrderRes)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"RetrnsItem":if(h.RetrnsItem===undefined){h.RetrnsItem=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.RetrnsItem=parseFloat(h.RetrnsItem)+parseFloat(I[Q].MRPElementOpenQuantity)}break}h.SafetyStk=parseFloat(I[Q].SafetyStk);h.AvailableStock=parseFloat(h.Stock)-parseFloat(h.SafetyStk);if(h.AvailableStock===undefined||h.AvailableStock==="NaN"){h.AvailableStock=0}if(h.AvailableStock<0){h.status="Warning"}var _=new Date(I[Q].MRPElementAvailyOrRqmtDate);var B=_.toISOString();h.MRPElementAvailyOrRqmtDate=B.substr(0,10);h.Material=I[Q].Material;h.MRPPlant=I[Q].MRPPlant;h.MRPArea=I[Q].MRPArea;h.MRPController=I[Q].MRPController;h.MRPAvailableQuantity=I[Q].MRPAvailableQuantity;if(I[Q].MRPAvailableQuantityDate!==undefined){h.MRPAvailableQuantityDate=I[Q].MRPAvailableQuantityDate.substr(0,10)}h.MaterialBaseUnit=I[Q].MaterialBaseUnit;h.MRPElementOpenQuantity=I[Q].MRPElementOpenQuantity;h.MaterialName=I[Q].MaterialName;q.push(h);h={}}else{if(I[Q].Material===I[Q+1].Material){N=I[Q].MRPElementCategoryShortName;T=N.trim();switch(T){case"Stock":if(h.Stock===undefined){h.Stock=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.Stock=parseFloat(h.Stock)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"DependReq":if(h.DependReq===undefined){h.DependReq=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.DependReq=parseFloat(h.DependReq)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"PurchReq":if(h.PurchReq===undefined){h.PurchReq=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.PurchReq=parseFloat(h.PurchReq)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"Plnd order":if(h.Plndorder===undefined){h.Plndorder=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.Plndorder=parseFloat(h.Plndorder)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"IndReqmt":if(h.IndReqmt===undefined){h.IndReqmt=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.IndReqmt=parseFloat(h.IndReqmt)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"Order":if(h.Order===undefined){h.Order=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.Order=parseFloat(h.Order)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"ProdOrder":if(h.ProdOrder===undefined){h.ProdOrder=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.ProdOrder=parseFloat(h.ProdOrder)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"Delivery":if(h.Delivery===undefined){h.Delivery=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.Delivery=parseFloat(h.Delivery)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"PO item":if(h.POitem===undefined){h.POitem=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.POitem=parseFloat(h.POitem)+parseFloat(I[Q].MRPElementOpenQuantity)}h.MRPElementBusinessPartner=I[Q].MRPElementBusinessPartner;break;case"OrderRes":if(h.OrderRes===undefined){h.OrderRes=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.OrderRes=parseFloat(h.OrderRes)+parseFloat(I[Q].MRPElementOpenQuantity)}break;case"RetrnsItem":if(h.RetrnsItem===undefined){h.RetrnsItem=parseFloat(I[Q].MRPElementOpenQuantity)}else{h.RetrnsItem=parseFloat(h.RetrnsItem)+parseFloat(I[Q].MRPElementOpenQuantity)}break}}if(V==="X"){if(h.SafetyStk===undefined){h.SafetyStk=0}h.SafetyStk=parseFloat(I[Q].SafetyStk);h.AvailableStock=parseFloat(h.Stock)-parseFloat(h.SafetyStk);if(h.AvailableStock===undefined||h.AvailableStock==="NaN"){h.AvailableStock=0}if(h.AvailableStock<0){h.status="Warning"}var _=new Date(I[Q].MRPElementAvailyOrRqmtDate);var B=_.toISOString();h.MRPElementAvailyOrRqmtDate=B.substr(0,10);h.Material=I[Q].Material;h.MRPPlant=I[Q].MRPPlant;h.MRPArea=I[Q].MRPArea;h.MRPController=I[Q].MRPController;h.MRPAvailableQuantity=I[Q].MRPAvailableQuantity;if(I[Q].MRPAvailableQuantityDate!==undefined){h.MRPAvailableQuantityDate=I[Q].MRPAvailableQuantityDate.substr(0,10)}h.MaterialBaseUnit=I[Q].MaterialBaseUnit;h.MRPElementOpenQuantity=I[Q].MRPElementOpenQuantity;h.MaterialName=I[Q].MaterialName;q.push(h);h={}}else{if(I[Q].Material!==I[Q+1].Material){if(h.SafetyStk===undefined){h.SafetyStk=0}h.SafetyStk=parseFloat(I[Q].SafetyStk);h.AvailableStock=parseFloat(h.Stock)-parseFloat(h.SafetyStk);if(h.AvailableStock===undefined||h.AvailableStock==="NaN"){h.AvailableStock=0}if(h.AvailableStock<0){h.status="Warning"}var _=new Date(I[Q].MRPElementAvailyOrRqmtDate);var B=_.toISOString();h.MRPElementAvailyOrRqmtDate=B.substr(0,10);h.Material=I[Q].Material;h.MRPPlant=I[Q].MRPPlant;h.MRPArea=I[Q].MRPArea;h.MRPController=I[Q].MRPController;h.MRPAvailableQuantity=I[Q].MRPAvailableQuantity;if(I[Q].MRPAvailableQuantityDate!==undefined){h.MRPAvailableQuantityDate=I[Q].MRPAvailableQuantityDate.substr(0,10)}h.MaterialBaseUnit=I[Q].MaterialBaseUnit;h.MRPElementOpenQuantity=I[Q].MRPElementOpenQuantity;h.MaterialName=I[Q].MaterialName;q.push(h);h={}}}}}v.BotList=q;var U=new sap.ui.model.json.JSONModel;var x=sap.ui.getCore().byId("container-mrpReport---Home--idTable");U.setData(v);x.setModel(U,"botTabModel");x.setVisible(true)}else{sap.m.MessageToast.show("Please provide Material Number, MRP Area and Plant value")}},sortCategories:function(e){var t=this.getView();var a=sap.ui.getCore().byId("container-mrpReport---Home--idTable");var r=t.byId("Material");a.sort(r,this._bSortColumnDescending?M.Descending:M.Ascending,true);this._bSortColumnDescending=!this._bSortColumnDescending},sortCategoriesAndName:function(e){var t=this.getView();var a=sap.ui.getCore().byId("container-mrpReport---Home--idTable");a.sort(t.byId("Material"),M.Ascending,false);a.sort(t.byId("MRPPlant"),M.Ascending,true)},sortDeliveryDate:function(e){var t=e.getParameter("column");var a=this.byId("deliverydate");if(t!=a){a.setSorted(false);return}e.preventDefault();var i=e.getParameter("sortOrder");var n=r.getDateInstance({pattern:"dd/MM/yyyy"});this._resetSortingState();a.setSorted(true);a.setSortOrder(i);var s=new l(a.getSortProperty(),i===M.Descending);s.fnCompare=function(e,t){if(t==null){return-1}if(e==null){return 1}var a=n.parse(e).getTime();var r=n.parse(t).getTime();if(a<r){return-1}if(a>r){return 1}return 0};this.byId("idTable").getBinding("rows").sort(s)},_resetSortingState:function(){var e=sap.ui.getCore().byId("container-mrpReport---Home--idTable");var t=e.getColumns();for(var a=0;a<t.length;a++){t[a].setSorted(false)}}})});